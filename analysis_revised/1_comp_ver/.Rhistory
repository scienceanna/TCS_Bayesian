theme_set(see::theme_abyss())
# use parallel cores for mcmc chains!
options(mc.cores = parallel::detectCores())
# reduce the number of decimal places
options(digits = 3)
# functions used for our Bayesian re-analysis
source("../scripts/our_functions.R")
# set seed to make sure everything is reproducible
set.seed(100320021)
source("../scripts/import_and_tidy.R")
summary(d)
# functions used for the analysis re-implementation
source("../scripts/reimplementation.R")
De <- map_dfr(unique(d$exp_id), calc_D_per_feature) %>%
mutate(exp_id = as_factor(exp_id),
d_feature = as_factor(d_feature),
d_feature = fct_relevel(d_feature, "yellow", "orange", "blue", "triangle", "semicircle", "diamond", "circle")) %>%
arrange(exp_id, d_feature)
De %>% filter(exp_id %in% c("1a", "3a")) %>%
knitr::kable(digits = 1) %>% kableExtra::kable_styling()
De %>% filter(exp_id %in% c("1b", "3b")) %>%
knitr::kable(digits = 1) %>% kableExtra::kable_styling()
De <- De %>%
mutate(d_feature = fct_relevel(d_feature, "orange diamond", "orange circle", "blue diamond", "blue circle", "yellow diamond", "yellow circle", "yellow triangle",
"blue triangle", "orange triangle", "yellow semicircle", "blue semicircle", "orange semicircle")) %>%
arrange(exp_id, d_feature)
De %>% filter(exp_id %in% c("2a", "2b", "2c", "4a", "4b", "4c")) %>%
knitr::kable(digits = 1) %>% kableExtra::kable_styling()
exps_to_predict <- c("2a", "2b", "2c", "4a", "4b", "4c")
Dp <- map_df(exps_to_predict, gen_exp_predictions, De)
left_join(Dp, De, by = c("exp_id", "d_feature")) %>%
pivot_longer(
cols = c(`best feature`, `orthog. contrast`, collinear),
values_to = "Dp",
names_to = "method") %>%
mutate(method = fct_relevel(method, "best feature", "orthog. contrast")) %>%
ggplot(aes(x = Dp, y = D, colour = method)) +
geom_point(color = "yellow1") +
geom_abline(linetype = 2, colour = "cyan") +
geom_smooth(method = "lm", formula = y ~ x, colour = "violetred3") +
stat_poly_eq(formula = y ~ x,
aes(label = paste(..eq.label.., ..rr.label.., sep = "*plain(\",\")~")),
parse = TRUE, size = 2.8, label.y = 0.9, coef.digits = 3, rr.digits = 4) +
facet_wrap(~ method) +
scale_x_continuous("predicted D", limits = c(0, 90), breaks = seq(0, 90, 10)) +
scale_y_continuous("empirical D", limits = c(0, 90), breaks = seq(0, 90, 10)) +
scale_colour_manual(values = c("yellow1", "yellow1", "yellow1"))
Dp_tmp <- left_join(Dp, De, by = c("exp_id", "d_feature")) %>%
pivot_longer(-c(exp_id, d_feature, D), names_to = "method", values_to = "Dp")
df_r2 <- tibble(exp_id = as.character(), method = as.character(), r2 = as.numeric())
for (e_id in exps_to_predict) {
for (meth in unique(Dp_tmp$method)) {
df <- filter(Dp_tmp, method == meth, exp_id == e_id)
r2 <- summary(lm(D ~ Dp, data = df))$r.squared
df_r2 <- add_row(df_r2,
exp_id = paste("Exp", e_id), method = meth, r2 = r2)
}
}
for (meth in unique(Dp_tmp$method)) {
df <- filter(Dp_tmp, method == meth)
r2 <- summary(lm(D ~ Dp, data = df))$r.squared
# print(meth)
# print(summary(lm(D ~ Dp, data = df))$r.squared)
df_r2 <- add_row(df_r2,
exp_id = "all", method = meth, r2 = r2)
}
df_r2 %>% pivot_wider(method, names_from = "exp_id", values_from = "r2") %>%
knitr::kable(digits = 4) %>% kableExtra::kable_styling()
rm(df_r2, Dp_tmp)
rt_pred_collinear <- map_dfr(exps_to_predict, predict_rt, 'collinear')
d %>% filter(exp_id %in% exps_to_predict, N_T > 0) %>%
group_by(exp_id, p_id, d_feature, N_T) %>%
summarise(mean_rt = mean(rt), .groups = "drop") %>%
group_by(exp_id,  d_feature, N_T) %>%
summarise(mean_rt = mean(mean_rt), .groups = "drop") %>%
left_join(rt_pred_collinear, by = c("exp_id", "d_feature", "N_T")) %>%
ggplot(aes(x = p_rt, y = mean_rt, colour = "yellow1")) +
geom_point(color = "yellow1", alpha = 0.5) +
geom_abline(linetype = 2, colour = "cyan") +
geom_smooth(method = "lm", formula = y ~ x, colour = "violetred3") +
stat_poly_eq(formula = y ~ x,
aes(label = paste(..eq.label.., ..rr.label.., sep = "*plain(\",\")~")),
parse = TRUE, size = 2.8, label.y = 0.9, coef.digits = 3, rr.digits = 4) +
coord_cartesian(ylim=c(400, 800), xlim=c(400,800)) +
scale_x_continuous("predicted reaction time (ms)") +
scale_y_continuous("empirical mean reaction time (ms)") +
scale_colour_manual(values = "yellow1") -> collinear_plot
rt_pred_orthog <- map_dfr(exps_to_predict, predict_rt, 'orthog. contrast')
d %>% filter(exp_id %in% exps_to_predict, N_T > 0) %>%
group_by(exp_id, p_id, d_feature, N_T) %>%
summarise(mean_rt = mean(rt), .groups = "drop") %>%
group_by(exp_id,  d_feature, N_T) %>%
summarise(mean_rt = mean(mean_rt), .groups = "drop") %>%
left_join(rt_pred_orthog, by = c("exp_id", "d_feature", "N_T")) %>%
ggplot(aes(x = p_rt, y = mean_rt, colour = "yellow1")) +
geom_point(color = "yellow1", alpha = 0.5) +
geom_abline(linetype = 2, colour = "cyan") +
geom_smooth(method = "lm", formula = y ~ x, colour = "violetred3") +
stat_poly_eq(formula = y ~ x,
aes(label = paste(..eq.label.., ..rr.label.., sep = "*plain(\",\")~")),
parse = TRUE, size = 2.8, label.y = 0.9, coef.digits = 3, rr.digits = 4) +
coord_cartesian(ylim=c(400, 800), xlim=c(400,800)) +
scale_x_continuous("predicted reaction time (ms)") +
scale_y_continuous("empirical mean reaction time (ms)") +
scale_colour_manual(values = "yellow1") -> orthog_plot
rt_pred_best <- map_dfr(exps_to_predict, predict_rt, 'best feature')
d %>% filter(exp_id %in% exps_to_predict, N_T > 0) %>%
group_by(exp_id, p_id, d_feature, N_T) %>%
summarise(mean_rt = mean(rt), .groups = "drop") %>%
group_by(exp_id,  d_feature, N_T) %>%
summarise(mean_rt = mean(mean_rt), .groups = "drop") %>%
left_join(rt_pred_best, by = c("exp_id", "d_feature", "N_T")) %>%
ggplot(aes(x = p_rt, y = mean_rt, colour = "yellow1")) +
geom_point(color = "yellow1", alpha = 0.5) +
geom_abline(linetype = 2, colour = "cyan") +
geom_smooth(method = "lm", formula = y ~ x, colour = "violetred3") +
stat_poly_eq(formula = y ~ x,
aes(label = paste(..eq.label.., ..rr.label.., sep = "*plain(\",\")~")),
parse = TRUE, size = 2.8, label.y = 0.9, coef.digits = 3, rr.digits = 4) +
coord_cartesian(ylim=c(400, 800), xlim=c(400,800)) +
scale_x_continuous("predicted reaction time (ms)") +
scale_y_continuous("empirical mean reaction time (ms)") +
scale_colour_manual(values = "yellow1") -> best_plot
best_plot + orthog_plot + collinear_plot
# remove variables we no longer need
rm(De, Dp, rt_pred_collinear, rt_pred_orthog, rt_pred_best, exps_to_predict,
extract_a_value, predict_D_overall, gen_exp_predictions, extract_D, predict_rt)
De <- map_dfr(c("1a", "1b", "2a"), calc_D_per_feature, "Bayes")
saveRDS(De, "tmp.model")
De %>%
mutate(
d_feature = as_factor(d_feature),
d_feature = fct_relevel(d_feature, "yellow", "orange", "blue", "triangle", "semicircle", "diamond", "circle")) %>%
arrange(exp_id, d_feature) %>%
group_by(exp_id, d_feature) %>%
mean_hdci(D, .width = 0.53) %>%
select(exp_id, d_feature, `53% lower` = ".lower", D, `53% upper` = ".upper") %>%
knitr::kable() %>% kableExtra::kable_styling()
exps_to_predict <- c("2a", "2b", "2c")
Dp <- map_df(exps_to_predict, gen_exp_predictions, De)
Dp
Dp <- map_df(exps_to_predict, gen_exp_predictions, De, "Bayes")
knitr::opts_chunk$set(
echo = TRUE,
fig.height = 3,
fig.align = "center")
library(tidyverse)
library(brms)
library(tidybayes)
library(patchwork)
library(latex2exp)
library(ggpmisc)
# set ggplot2 theme
theme_set(see::theme_abyss())
# use parallel cores for mcmc chains!
options(mc.cores = parallel::detectCores())
# reduce the number of decimal places
options(digits = 3)
# functions used for our Bayesian re-analysis
source("../scripts/our_functions.R")
# set seed to make sure everything is reproducible
set.seed(100320021)
source("../scripts/import_and_tidy.R")
summary(d)
# functions used for the analysis re-implementation
source("../scripts/reimplementation.R")
De <- map_dfr(unique(d$exp_id), calc_D_per_feature) %>%
mutate(exp_id = as_factor(exp_id),
d_feature = as_factor(d_feature),
d_feature = fct_relevel(d_feature, "yellow", "orange", "blue", "triangle", "semicircle", "diamond", "circle")) %>%
arrange(exp_id, d_feature)
De %>% filter(exp_id %in% c("1a", "3a")) %>%
knitr::kable(digits = 1) %>% kableExtra::kable_styling()
De %>% filter(exp_id %in% c("1b", "3b")) %>%
knitr::kable(digits = 1) %>% kableExtra::kable_styling()
De <- De %>%
mutate(d_feature = fct_relevel(d_feature, "orange diamond", "orange circle", "blue diamond", "blue circle", "yellow diamond", "yellow circle", "yellow triangle",
"blue triangle", "orange triangle", "yellow semicircle", "blue semicircle", "orange semicircle")) %>%
arrange(exp_id, d_feature)
De %>% filter(exp_id %in% c("2a", "2b", "2c", "4a", "4b", "4c")) %>%
knitr::kable(digits = 1) %>% kableExtra::kable_styling()
exps_to_predict <- c("2a", "2b", "2c", "4a", "4b", "4c")
Dp <- map_df(exps_to_predict, gen_exp_predictions, De)
left_join(Dp, De, by = c("exp_id", "d_feature")) %>%
pivot_longer(
cols = c(`best feature`, `orthog. contrast`, collinear),
values_to = "Dp",
names_to = "method") %>%
mutate(method = fct_relevel(method, "best feature", "orthog. contrast")) %>%
ggplot(aes(x = Dp, y = D, colour = method)) +
geom_point(color = "yellow1") +
geom_abline(linetype = 2, colour = "cyan") +
geom_smooth(method = "lm", formula = y ~ x, colour = "violetred3") +
stat_poly_eq(formula = y ~ x,
aes(label = paste(..eq.label.., ..rr.label.., sep = "*plain(\",\")~")),
parse = TRUE, size = 2.8, label.y = 0.9, coef.digits = 3, rr.digits = 4) +
facet_wrap(~ method) +
scale_x_continuous("predicted D", limits = c(0, 90), breaks = seq(0, 90, 10)) +
scale_y_continuous("empirical D", limits = c(0, 90), breaks = seq(0, 90, 10)) +
scale_colour_manual(values = c("yellow1", "yellow1", "yellow1"))
Dp_tmp <- left_join(Dp, De, by = c("exp_id", "d_feature")) %>%
pivot_longer(-c(exp_id, d_feature, D), names_to = "method", values_to = "Dp")
df_r2 <- tibble(exp_id = as.character(), method = as.character(), r2 = as.numeric())
for (e_id in exps_to_predict) {
for (meth in unique(Dp_tmp$method)) {
df <- filter(Dp_tmp, method == meth, exp_id == e_id)
r2 <- summary(lm(D ~ Dp, data = df))$r.squared
df_r2 <- add_row(df_r2,
exp_id = paste("Exp", e_id), method = meth, r2 = r2)
}
}
for (meth in unique(Dp_tmp$method)) {
df <- filter(Dp_tmp, method == meth)
r2 <- summary(lm(D ~ Dp, data = df))$r.squared
# print(meth)
# print(summary(lm(D ~ Dp, data = df))$r.squared)
df_r2 <- add_row(df_r2,
exp_id = "all", method = meth, r2 = r2)
}
df_r2 %>% pivot_wider(method, names_from = "exp_id", values_from = "r2") %>%
knitr::kable(digits = 4) %>% kableExtra::kable_styling()
rm(df_r2, Dp_tmp)
rt_pred_collinear <- map_dfr(exps_to_predict, predict_rt, 'collinear')
d %>% filter(exp_id %in% exps_to_predict, N_T > 0) %>%
group_by(exp_id, p_id, d_feature, N_T) %>%
summarise(mean_rt = mean(rt), .groups = "drop") %>%
group_by(exp_id,  d_feature, N_T) %>%
summarise(mean_rt = mean(mean_rt), .groups = "drop") %>%
left_join(rt_pred_collinear, by = c("exp_id", "d_feature", "N_T")) %>%
ggplot(aes(x = p_rt, y = mean_rt, colour = "yellow1")) +
geom_point(color = "yellow1", alpha = 0.5) +
geom_abline(linetype = 2, colour = "cyan") +
geom_smooth(method = "lm", formula = y ~ x, colour = "violetred3") +
stat_poly_eq(formula = y ~ x,
aes(label = paste(..eq.label.., ..rr.label.., sep = "*plain(\",\")~")),
parse = TRUE, size = 2.8, label.y = 0.9, coef.digits = 3, rr.digits = 4) +
coord_cartesian(ylim=c(400, 800), xlim=c(400,800)) +
scale_x_continuous("predicted reaction time (ms)") +
scale_y_continuous("empirical mean reaction time (ms)") +
scale_colour_manual(values = "yellow1") -> collinear_plot
rt_pred_orthog <- map_dfr(exps_to_predict, predict_rt, 'orthog. contrast')
d %>% filter(exp_id %in% exps_to_predict, N_T > 0) %>%
group_by(exp_id, p_id, d_feature, N_T) %>%
summarise(mean_rt = mean(rt), .groups = "drop") %>%
group_by(exp_id,  d_feature, N_T) %>%
summarise(mean_rt = mean(mean_rt), .groups = "drop") %>%
left_join(rt_pred_orthog, by = c("exp_id", "d_feature", "N_T")) %>%
ggplot(aes(x = p_rt, y = mean_rt, colour = "yellow1")) +
geom_point(color = "yellow1", alpha = 0.5) +
geom_abline(linetype = 2, colour = "cyan") +
geom_smooth(method = "lm", formula = y ~ x, colour = "violetred3") +
stat_poly_eq(formula = y ~ x,
aes(label = paste(..eq.label.., ..rr.label.., sep = "*plain(\",\")~")),
parse = TRUE, size = 2.8, label.y = 0.9, coef.digits = 3, rr.digits = 4) +
coord_cartesian(ylim=c(400, 800), xlim=c(400,800)) +
scale_x_continuous("predicted reaction time (ms)") +
scale_y_continuous("empirical mean reaction time (ms)") +
scale_colour_manual(values = "yellow1") -> orthog_plot
rt_pred_best <- map_dfr(exps_to_predict, predict_rt, 'best feature')
d %>% filter(exp_id %in% exps_to_predict, N_T > 0) %>%
group_by(exp_id, p_id, d_feature, N_T) %>%
summarise(mean_rt = mean(rt), .groups = "drop") %>%
group_by(exp_id,  d_feature, N_T) %>%
summarise(mean_rt = mean(mean_rt), .groups = "drop") %>%
left_join(rt_pred_best, by = c("exp_id", "d_feature", "N_T")) %>%
ggplot(aes(x = p_rt, y = mean_rt, colour = "yellow1")) +
geom_point(color = "yellow1", alpha = 0.5) +
geom_abline(linetype = 2, colour = "cyan") +
geom_smooth(method = "lm", formula = y ~ x, colour = "violetred3") +
stat_poly_eq(formula = y ~ x,
aes(label = paste(..eq.label.., ..rr.label.., sep = "*plain(\",\")~")),
parse = TRUE, size = 2.8, label.y = 0.9, coef.digits = 3, rr.digits = 4) +
coord_cartesian(ylim=c(400, 800), xlim=c(400,800)) +
scale_x_continuous("predicted reaction time (ms)") +
scale_y_continuous("empirical mean reaction time (ms)") +
scale_colour_manual(values = "yellow1") -> best_plot
best_plot + orthog_plot + collinear_plot
# remove variables we no longer need
rm(De, Dp, rt_pred_collinear, rt_pred_orthog, rt_pred_best, exps_to_predict,
extract_a_value, predict_D_overall, extract_D, predict_rt)
De <- map_dfr(c("1a", "1b", "2a"), calc_D_per_feature, "Bayes")
saveRDS(De, "tmp.model")
De %>%
mutate(
d_feature = as_factor(d_feature),
d_feature = fct_relevel(d_feature, "yellow", "orange", "blue", "triangle", "semicircle", "diamond", "circle")) %>%
arrange(exp_id, d_feature) %>%
group_by(exp_id, d_feature) %>%
mean_hdci(D, .width = 0.53) %>%
select(exp_id, d_feature, `53% lower` = ".lower", D, `53% upper` = ".upper") %>%
knitr::kable() %>% kableExtra::kable_styling()
exps_to_predict <- c("2a", "2b", "2c")
Dp <- map_df(exps_to_predict, gen_exp_predictions, De, "Bayes")
knitr::opts_chunk$set(
echo = TRUE,
fig.height = 3,
fig.align = "center")
library(tidyverse)
library(brms)
library(tidybayes)
library(patchwork)
library(latex2exp)
library(ggpmisc)
# set ggplot2 theme
theme_set(see::theme_abyss())
# use parallel cores for mcmc chains!
options(mc.cores = parallel::detectCores())
# reduce the number of decimal places
options(digits = 3)
# functions used for our Bayesian re-analysis
source("../scripts/our_functions.R")
# set seed to make sure everything is reproducible
set.seed(100320021)
source("../scripts/import_and_tidy.R")
summary(d)
# functions used for the analysis re-implementation
source("../scripts/reimplementation.R")
De <- map_dfr(unique(d$exp_id), calc_D_per_feature) %>%
mutate(exp_id = as_factor(exp_id),
d_feature = as_factor(d_feature),
d_feature = fct_relevel(d_feature, "yellow", "orange", "blue", "triangle", "semicircle", "diamond", "circle")) %>%
arrange(exp_id, d_feature)
De %>% filter(exp_id %in% c("1a", "3a")) %>%
knitr::kable(digits = 1) %>% kableExtra::kable_styling()
De %>% filter(exp_id %in% c("1b", "3b")) %>%
knitr::kable(digits = 1) %>% kableExtra::kable_styling()
De <- De %>%
mutate(d_feature = fct_relevel(d_feature, "orange diamond", "orange circle", "blue diamond", "blue circle", "yellow diamond", "yellow circle", "yellow triangle",
"blue triangle", "orange triangle", "yellow semicircle", "blue semicircle", "orange semicircle")) %>%
arrange(exp_id, d_feature)
De %>% filter(exp_id %in% c("2a", "2b", "2c", "4a", "4b", "4c")) %>%
knitr::kable(digits = 1) %>% kableExtra::kable_styling()
exps_to_predict <- c("2a", "2b", "2c", "4a", "4b", "4c")
Dp <- map_df(exps_to_predict, gen_exp_predictions, De)
left_join(Dp, De, by = c("exp_id", "d_feature")) %>%
pivot_longer(
cols = c(`best feature`, `orthog. contrast`, collinear),
values_to = "Dp",
names_to = "method") %>%
mutate(method = fct_relevel(method, "best feature", "orthog. contrast")) %>%
ggplot(aes(x = Dp, y = D, colour = method)) +
geom_point(color = "yellow1") +
geom_abline(linetype = 2, colour = "cyan") +
geom_smooth(method = "lm", formula = y ~ x, colour = "violetred3") +
stat_poly_eq(formula = y ~ x,
aes(label = paste(..eq.label.., ..rr.label.., sep = "*plain(\",\")~")),
parse = TRUE, size = 2.8, label.y = 0.9, coef.digits = 3, rr.digits = 4) +
facet_wrap(~ method) +
scale_x_continuous("predicted D", limits = c(0, 90), breaks = seq(0, 90, 10)) +
scale_y_continuous("empirical D", limits = c(0, 90), breaks = seq(0, 90, 10)) +
scale_colour_manual(values = c("yellow1", "yellow1", "yellow1"))
Dp_tmp <- left_join(Dp, De, by = c("exp_id", "d_feature")) %>%
pivot_longer(-c(exp_id, d_feature, D), names_to = "method", values_to = "Dp")
df_r2 <- tibble(exp_id = as.character(), method = as.character(), r2 = as.numeric())
for (e_id in exps_to_predict) {
for (meth in unique(Dp_tmp$method)) {
df <- filter(Dp_tmp, method == meth, exp_id == e_id)
r2 <- summary(lm(D ~ Dp, data = df))$r.squared
df_r2 <- add_row(df_r2,
exp_id = paste("Exp", e_id), method = meth, r2 = r2)
}
}
for (meth in unique(Dp_tmp$method)) {
df <- filter(Dp_tmp, method == meth)
r2 <- summary(lm(D ~ Dp, data = df))$r.squared
# print(meth)
# print(summary(lm(D ~ Dp, data = df))$r.squared)
df_r2 <- add_row(df_r2,
exp_id = "all", method = meth, r2 = r2)
}
df_r2 %>% pivot_wider(method, names_from = "exp_id", values_from = "r2") %>%
knitr::kable(digits = 4) %>% kableExtra::kable_styling()
rm(df_r2, Dp_tmp)
rt_pred_collinear <- map_dfr(exps_to_predict, predict_rt, 'collinear')
d %>% filter(exp_id %in% exps_to_predict, N_T > 0) %>%
group_by(exp_id, p_id, d_feature, N_T) %>%
summarise(mean_rt = mean(rt), .groups = "drop") %>%
group_by(exp_id,  d_feature, N_T) %>%
summarise(mean_rt = mean(mean_rt), .groups = "drop") %>%
left_join(rt_pred_collinear, by = c("exp_id", "d_feature", "N_T")) %>%
ggplot(aes(x = p_rt, y = mean_rt, colour = "yellow1")) +
geom_point(color = "yellow1", alpha = 0.5) +
geom_abline(linetype = 2, colour = "cyan") +
geom_smooth(method = "lm", formula = y ~ x, colour = "violetred3") +
stat_poly_eq(formula = y ~ x,
aes(label = paste(..eq.label.., ..rr.label.., sep = "*plain(\",\")~")),
parse = TRUE, size = 2.8, label.y = 0.9, coef.digits = 3, rr.digits = 4) +
coord_cartesian(ylim=c(400, 800), xlim=c(400,800)) +
scale_x_continuous("predicted reaction time (ms)") +
scale_y_continuous("empirical mean reaction time (ms)") +
scale_colour_manual(values = "yellow1") -> collinear_plot
rt_pred_orthog <- map_dfr(exps_to_predict, predict_rt, 'orthog. contrast')
d %>% filter(exp_id %in% exps_to_predict, N_T > 0) %>%
group_by(exp_id, p_id, d_feature, N_T) %>%
summarise(mean_rt = mean(rt), .groups = "drop") %>%
group_by(exp_id,  d_feature, N_T) %>%
summarise(mean_rt = mean(mean_rt), .groups = "drop") %>%
left_join(rt_pred_orthog, by = c("exp_id", "d_feature", "N_T")) %>%
ggplot(aes(x = p_rt, y = mean_rt, colour = "yellow1")) +
geom_point(color = "yellow1", alpha = 0.5) +
geom_abline(linetype = 2, colour = "cyan") +
geom_smooth(method = "lm", formula = y ~ x, colour = "violetred3") +
stat_poly_eq(formula = y ~ x,
aes(label = paste(..eq.label.., ..rr.label.., sep = "*plain(\",\")~")),
parse = TRUE, size = 2.8, label.y = 0.9, coef.digits = 3, rr.digits = 4) +
coord_cartesian(ylim=c(400, 800), xlim=c(400,800)) +
scale_x_continuous("predicted reaction time (ms)") +
scale_y_continuous("empirical mean reaction time (ms)") +
scale_colour_manual(values = "yellow1") -> orthog_plot
rt_pred_best <- map_dfr(exps_to_predict, predict_rt, 'best feature')
d %>% filter(exp_id %in% exps_to_predict, N_T > 0) %>%
group_by(exp_id, p_id, d_feature, N_T) %>%
summarise(mean_rt = mean(rt), .groups = "drop") %>%
group_by(exp_id,  d_feature, N_T) %>%
summarise(mean_rt = mean(mean_rt), .groups = "drop") %>%
left_join(rt_pred_best, by = c("exp_id", "d_feature", "N_T")) %>%
ggplot(aes(x = p_rt, y = mean_rt, colour = "yellow1")) +
geom_point(color = "yellow1", alpha = 0.5) +
geom_abline(linetype = 2, colour = "cyan") +
geom_smooth(method = "lm", formula = y ~ x, colour = "violetred3") +
stat_poly_eq(formula = y ~ x,
aes(label = paste(..eq.label.., ..rr.label.., sep = "*plain(\",\")~")),
parse = TRUE, size = 2.8, label.y = 0.9, coef.digits = 3, rr.digits = 4) +
coord_cartesian(ylim=c(400, 800), xlim=c(400,800)) +
scale_x_continuous("predicted reaction time (ms)") +
scale_y_continuous("empirical mean reaction time (ms)") +
scale_colour_manual(values = "yellow1") -> best_plot
best_plot + orthog_plot + collinear_plot
# remove variables we no longer need
rm(De, Dp, rt_pred_collinear, rt_pred_orthog, rt_pred_best, exps_to_predict,
extract_a_value, extract_D, predict_rt)
De <- map_dfr(c("1a", "1b", "2a"), calc_D_per_feature, "Bayes")
saveRDS(De, "tmp.model")
De %>%
mutate(
d_feature = as_factor(d_feature),
d_feature = fct_relevel(d_feature, "yellow", "orange", "blue", "triangle", "semicircle", "diamond", "circle")) %>%
arrange(exp_id, d_feature) %>%
group_by(exp_id, d_feature) %>%
mean_hdci(D, .width = 0.53) %>%
select(exp_id, d_feature, `53% lower` = ".lower", D, `53% upper` = ".upper") %>%
knitr::kable() %>% kableExtra::kable_styling()
exps_to_predict <- c("2a", "2b", "2c")
Dp <- map_df(exps_to_predict, gen_exp_predictions, De, "Bayes")
Dp
Dp %>% mutate(d_feature = str_trim(d_feature) )
?Str_trim
str_trim
?str_trim
Dp %>% mutate(d_feature = str_squish(d_feature) )
Dp %>% mutate(d_feature = str_replace(d_feature, " ", ""))
d_feature2 = d_feature,
Dp %>% mutate(
d_feature2 = d_feature,
d_feature = str_replace(d_feature, " ", "")) %>%
left_join(De)
d_feature2 = d_feature,
Dp %>% mutate(
d_feature2 = d_feature,
d_feature = str_replace(d_feature, " ", "")) %>%
left_join(De) %>%
mutate(d_feature = d_feature2) %>%
select(-d_feature2)
d_feature2 = d_feature,
Dp %>% mutate(
d_feature2 = d_feature,
d_feature = str_replace(d_feature, " ", "")) %>%
left_join(De, by = "d_feature") %>%
mutate(d_feature = d_feature2) %>%
select(-d_feature2)
Dp %>% mutate(
d_feature2 = d_feature,
d_feature = str_replace(d_feature, " ", "")) %>%
left_join(De, by = c(exp_id, "d_feature")) %>%
mutate(d_feature = d_feature2) %>%
select(-d_feature2)
Dp %>% mutate(d_feature2 = str_replace(d_feature, " ", ""))
Dp %>% mutate(
d_feature2 = d_feature,
d_feature = str_replace(d_feature, " ", ""))
De
Dp %>% mutate(
d_feature2 = d_feature,
d_feature = str_replace(d_feature, " ", "")) %>%
left_join(De, by = c(exp_id, "d_feature"))
Dp %>% mutate(
d_feature2 = d_feature,
d_feature = str_replace(d_feature, " ", "")) %>%
left_join(De, by = c("exp_id", "d_feature")) %>%
mutate(d_feature = d_feature2) %>%
select(-d_feature2)
Dp %>% mutate(
d_feature2 = d_feature,
d_feature = str_replace(d_feature, " ", ""))
De
d_feature2 = d_feature,
Dp %>% mutate(
d_feature2 = d_feature,
d_feature = str_replace(d_feature, " ", "")) %>%
left_join(filter(De, exp_id %in% exps_to_predict), by = c("exp_id", "d_feature")) %>%
mutate(d_feature = d_feature2) %>%
select(-d_feature2)
Dp %>% mutate(
d_feature2 = d_feature,
d_feature = str_replace(d_feature, " ", ""))
filter(De, exp_id %in% exps_to_predict)
Dp
tail(Dp)
exps_to_predict <- c("2a", "2b", "2c")
Dp <- map_df(exps_to_predict, gen_exp_predictions, De, "Bayes")
Dp
De
